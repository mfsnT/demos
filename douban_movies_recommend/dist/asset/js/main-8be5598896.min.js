!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e){t.exports=jQuery},function(t,e,n){var i=n(0),s=n(2),r=n(3);i(function(){!function(){var t=i("section"),e=i(".btn-group"),n=e.children(),c=i(".top"),a=i(".north-america"),o=i(".search"),u=a.children(".movie-list"),l=new r(c.children(".movie-list")),d=new r(u),h=new r(o.children(".movie-list"));new s(c.children(".update-icon"),c,!0,function(t){l.getMovies("top250")}),new s(o.children(".update-icon"),o,!1,function(t){h.getMovies("search")}),e.on("click","li",function(){var e=i(this),s=e.index();e.hasClass("active-btn")||(1===s&&u.html()||(a.children(".update-icon").addClass("rotate"),d.getMovies("us_box",function(t){t.hide()})),t.eq(s).addClass("current-section").siblings().removeClass("current-section"),n.eq(s).addClass("active-btn").siblings().removeClass("active-btn"))})}()})},function(t,e,n){function i(t,e,n,i){this.$target=t,this.$target_ct=e,this.handle=i,this.timer=null,this.shouldTriggerFirstTime=n,this.bind()}var s=n(0);i.prototype={bind:function(){function t(t,e){return t.offset().top<e.height()}var e=this.$target,n=this;this.$target_ct.on("scroll",function(){clearTimeout(n.timer),t(e,s(this))&&(setTimeout(function(){e.addClass("rotate")},20),n.timer=setTimeout(function(){n.handle(e)},1e3))}),n.shouldTriggerFirstTime&&e.trigger("scroll")}},t.exports=i},function(t,e,n){function i(t){if(this.$ct=t,this.start=0,this.$icon=t.siblings(".update-icon"),this.canGetMovies=!0,t.parent().hasClass("search")){var e=t.siblings(".search-bar");this.$input=e.children(".input"),this.$btn=e.children(".search-btn"),this.current_query_str="",this.bind()}}var s=n(0);i.prototype={bind:function(){var t=this.$input,e=this.$btn,n=this.$icon,i=this.$ct,s=this;e.on("click",function(){if(s.canGetMovies){var e=t.val();if(/^\s*$/.test(e))return;s.current_query_str!==e&&(s.current_query_str=e,i.empty(),s.start=0),n.show().addClass("rotate"),s.getMovies("search")}})},getMovies:function(t,e){function n(t,e){var n=document.createDocumentFragment(),i='<li class="movie-list-item"><a><div class="cover"><img></div><div class="movie-message"><h2></h2><p><span class="score"></span>分 / <span class="collect"></span>收藏</p><p><span class="year"></span> / <span class="type"></span></p><p>导演：<span class="director"></span></p><p>主演：<span class="actor"></span></p></div></a></li>';"豆瓣电影北美票房榜"===e.title?e.subjects.forEach(function(t){var e="",r="",c=s(i);t.subject.directors.forEach(function(e,n){n===t.subject.directors.length-1?r+=e.name:r+=e.name+"、"}),t.subject.casts.forEach(function(n,i){i===t.subject.casts.length-1?e+=n.name:e+=n.name+"、"}),c.find("a")[0].href=t.subject.alt,c.find(".cover img")[0].src=t.subject.images.medium,c.find("h2").text(t.subject.title),c.find(".score").text(t.subject.rating.average),c.find(".collect").text(t.subject.collect_count),c.find(".year").text(t.subject.year),c.find(".type").text(t.subject.genres.join(" / ")),c.find(".director").text(r),c.find(".actor").text(e),n.appendChild(c[0])}):e.subjects.forEach(function(t){var e="",r="",c=s(i);t.directors.forEach(function(e,n){n===t.directors.length-1?r+=e.name:r+=e.name+"、"}),t.casts.forEach(function(n,i){i===t.casts.length-1?e+=n.name:e+=n.name+"、"}),c.find("a")[0].href=t.alt,c.find("h2").text(t.title),c.find(".cover img")[0].src=t.images.medium,c.find(".score").text(t.rating.average),c.find(".collect").text(t.collect_count),c.find(".year").text(t.year),c.find(".type").text(t.genres.join(" / ")),c.find(".director").text(r),c.find(".actor").text(e),n.appendChild(c[0])}),t.append(n)}if(this.canGetMovies){this.canGetMovies=!1;var i=this,r=this.$icon,c={dataType:"jsonp",data:{start:i.start}};"top250"===t?c.url="https://api.douban.com/v2/movie/top250":"us_box"===t?c.url="https://api.douban.com/v2/movie/us_box":"search"===t&&(c.url="https://api.douban.com/v2/movie/search",c.data.q=this.current_query_str),s.ajax(c).done(function(t){n(i.$ct,t),r.removeClass("rotate"),e&&e(r),i.start+=20,i.canGetMovies=!0}).fail(function(){console.log("出错了")})}}},t.exports=i}]);